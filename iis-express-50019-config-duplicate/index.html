<!doctype html><html lang=zh-tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>IIS Express 出現 500.19 - 0x800700b7 錯誤？！ - Yowko&#39;s Notes</title><meta name=renderer content=webkit><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content=no-transform><meta http-equiv=cache-control content=no-siteapp><meta name=theme-color content=#f8f5ec><meta name=msapplication-navbutton-color content=#f8f5ec><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=#f8f5ec><meta name=author content="Yowko Tsai"><meta name=description content="IIS Express 出現 500.19 - 0x800700b7 錯誤？！ 同事請我協助測試一段程式碼，一如往常的 clone source code，使用 Visual Studio 開啟 .sln，按下 F6 restore NuGet packages and build success，接著 Ctrl&#43;F5 啟動不"><meta name=keywords content=yowko,.net,blog><meta name=generator content="Hugo 0.56.3"><meta name=msvalidate.01 content=FA1ADBDB8F0BBBD0F7F4E65CDEBF7898><link rel=canonical href=https://blog.yowko.com/iis-express-50019-config-duplicate/><link rel=apple-touch-icon sizes=180x180 href=https://blog.yowko.com/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://blog.yowko.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://blog.yowko.com/favicon-16x16.png><link rel=manifest href=https://blog.yowko.com/manifest.json><link rel=mask-icon href=https://blog.yowko.com/safari-pinned-tab.svg color=#5bbad5><link href="https://blog.yowko.com/dist/even.min.css?v=3.2.0" rel=stylesheet><link href=https://blog.yowko.com/lib/fancybox/jquery.fancybox-3.1.20.min.css rel=stylesheet><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.2.0/css/all.css integrity=sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ crossorigin=anonymous><meta property=og:title content="IIS Express 出現 500.19 - 0x800700b7 錯誤？！"><meta property=og:description content="IIS Express 出現 500.19 - 0x800700b7 錯誤？！ 同事請我協助測試一段程式碼，一如往常的 clone source code，使用 Visual Studio 開啟 .sln，按下 F6 restore NuGet packages and build success，接著 Ctrl&#43;F5 啟動不"><meta property=og:type content=article><meta property=og:url content=https://blog.yowko.com/iis-express-50019-config-duplicate/><meta property=article:published_time content=2017-06-28T21:00:00+08:00><meta property=article:modified_time content=2020-09-01T21:00:56+08:00><meta itemprop=name content="IIS Express 出現 500.19 - 0x800700b7 錯誤？！"><meta itemprop=description content="IIS Express 出現 500.19 - 0x800700b7 錯誤？！ 同事請我協助測試一段程式碼，一如往常的 clone source code，使用 Visual Studio 開啟 .sln，按下 F6 restore NuGet packages and build success，接著 Ctrl&#43;F5 啟動不"><meta itemprop=datePublished content=2017-06-28T21:00:00&#43;08:00><meta itemprop=dateModified content=2020-09-01T21:00:56&#43;08:00><meta itemprop=wordCount content=1083><meta itemprop=keywords content="Debug,IIS Express,web.config,"><meta name=twitter:card content=summary><meta name=twitter:title content="IIS Express 出現 500.19 - 0x800700b7 錯誤？！"><meta name=twitter:description content="IIS Express 出現 500.19 - 0x800700b7 錯誤？！ 同事請我協助測試一段程式碼，一如往常的 clone source code，使用 Visual Studio 開啟 .sln，按下 F6 restore NuGet packages and build success，接著 Ctrl&#43;F5 啟動不"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--><link href=https://blog.yowko.com/opensearch.xml rel=search title="Content search" type=application/opensearchdescription+xml></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=https://blog.yowko.com/ class=logo>Yowko&#39;s Notes</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=https://blog.yowko.com/><li class=mobile-menu-item>首頁</li></a><a href=https://blog.yowko.com/post/><li class=mobile-menu-item>歷史筆記</li></a><a href=https://blog.yowko.com/tags/><li class=mobile-menu-item>內容標籤</li></a><a href=https://blog.yowko.com/search><li class=mobile-menu-item>站內搜尋</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header style=height:118px;padding-bottom:0><div class=logo-wrapper><a href=https://blog.yowko.com/ class=logo>Yowko&#39;s Notes</a></div><div style=padding-bottom:60px></div></nav><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=https://blog.yowko.com/>首頁</a></li><li class=menu-item><a class=menu-item-link href=https://blog.yowko.com/post/>歷史筆記</a></li><li class=menu-item><a class=menu-item-link href=https://blog.yowko.com/tags/>內容標籤</a></li><li class=menu-item><a class=menu-item-link href=https://blog.yowko.com/search>站內搜尋</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><hr style="border-top:1px solid #e6e6e6;border-bottom:0;padding:0"><div id=content class=content><article class=post><header class=post-header><div class=post-meta><span class=post-time>2017-06-28</span>
<span class=more-meta>約 1083 字</span>
<span class=more-meta>預計閱讀 3 分鐘</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>文章目錄</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><a href=#iis-express-出現-500-19-0x800700b7-錯誤>IIS Express 出現 500.19 - 0x800700b7 錯誤？！</a><ul><li><a href=#錯誤訊息>錯誤訊息</a></li><li><a href=#開始-debug>開始 Debug</a></li><li><a href=#心得>心得</a></li></ul></li><li><a href=#參考資訊>參考資訊</a></li></ul></nav></div></div><div class=post-content><h1 id=iis-express-出現-500-19-0x800700b7-錯誤>IIS Express 出現 500.19 - 0x800700b7 錯誤？！</h1><p>同事請我協助測試一段程式碼，一如往常的 clone source code，使用 Visual Studio 開啟 .sln，按下 F6 restore NuGet packages and build success，接著 Ctrl+F5 啟動不偵錯，一切都如此熟悉自然，但這前次出現的卻是 <code>HTTP Error 500.19 - Internal Server Error</code> 的錯誤而不是預期中的正常執行畫面，詭異的是錯誤訊息只在我的電腦上出現(人品問題又來了？！)</p><p>雖說錯誤畫面也不算罕見，但這次看到的錯誤卻不太一樣，解決方式也比較少見，所以特別紀錄一下</p><h2 id=錯誤訊息>錯誤訊息</h2><ul><li><p>訊息內容</p><pre><code>HTTP Error 500.19 - Internal Server Error
The requested page cannot be accessed because the related configuration data for the page is invalid.
</code></pre></li></ul><ol><li><p>Detailed Error Information:</p><pre><code>Module    IIS Web Core
Notification    Unknown
Handler    Not yet determined
Error Code    0x800700b7
Config Error    There is a duplicate 'oracle.manageddataaccess.client' section defined
Config File    \\?\D:\Svn_Source\******.Messaging.Web\web.config
Requested URL    http://localhost:47278/
Physical Path    
Logon Method    Not yet determined
Logon User    Not yet determined
Request Tracing Directory    C:\Users\yowko.tsai\Documents\IISExpress\TraceLogFiles\
</code></pre></li><li><p>Config Source:</p><pre><code>8:     &lt;section name=&quot;nlog&quot; type=&quot;NLog.Config.ConfigSectionHandler, NLog&quot; /&gt;
9:     &lt;section name=&quot;oracle.manageddataaccess.client&quot; type=&quot;OracleInternal.Common.ODPMSectionHandler, Oracle.ManagedDataAccess&quot; /&gt;
10:     &lt;section name=&quot;entityFramework&quot; type=&quot;System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot; requirePermission=&quot;false&quot; /&gt;
</code></pre></li><li><p>More Information:</p><pre><code>This error occurs when there is a problem reading the configuration file for the Web server or Web application. In some cases, the event logs may contain more information about what caused this error.
If you see the text &quot;There is a duplicate 'system.web.extensions/scripting/scriptResourceHandler' section defined&quot;, this error is because you are running a .NET Framework 3.5-based application in .NET Framework 4. If you are running WebMatrix, to resolve this problem, go to the Settings node to set the .NET Framework version to &quot;.NET 2&quot;. You can also remove the extra sections from the web.config file.
</code></pre></li><li><p>錯誤截圖</p><p><img src=https://user-images.githubusercontent.com/3851540/27622729-84b65c2c-5c0b-11e7-8c6c-32168d18022c.png alt=1errormsg></p></li></ol><h2 id=開始-debug>開始 Debug</h2><ol><li><p>Detailed Error Information 中有提到 Config Error</p><blockquote><p><code>There is a duplicate 'oracle.manageddataaccess.client' section defined</code></p></blockquote><p><img src=https://user-images.githubusercontent.com/3851540/27622727-84b374bc-5c0b-11e7-9591-0e6ed0356b3e.png alt=2configerror></p></li><li><p>檢查 web.config 檔，內容很單純一目瞭然不可能重複，web.config 如下</p><pre><code class=language-xml>&lt;configSections&gt;
    &lt;section name=&quot;nlog&quot; type=&quot;NLog.Config.ConfigSectionHandler, NLog&quot; /&gt;
    &lt;section name=&quot;oracle.manageddataaccess.client&quot; type=&quot;OracleInternal.Common.ODPMSectionHandler, Oracle.ManagedDataAccess&quot; /&gt;
    &lt;section name=&quot;entityFramework&quot; type=&quot;System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot; requirePermission=&quot;false&quot; /&gt;
&lt;/configSections&gt;
</code></pre></li><li><p>google 到黑大文章 <a href=http://blog.darkthread.net/post-2014-04-22-duplicated-handler-entry-in-webconfig.aspx target=_blank>【茶包射手日記】怪異的web.config HttpHandler重複錯誤</a> 可能是吃到上層的 web.config</p><ul><li><p>這是直接啟動 iis express 執行的，看一下專案 property 設定</p><p><img src=https://user-images.githubusercontent.com/3851540/27622728-84b3903c-5c0b-11e7-920c-f078b58ff70b.png alt=3webproperty></p></li><li><p>確認沒有上層資料夾，排除吃到上層 web.config 設定的可能</p></li></ul></li><li><p>嘗試把 web.config 提示重複的區段註解掉還真的可以正常執行XD</p><pre><code class=language-xml>&lt;configSections&gt;
    &lt;section name=&quot;nlog&quot; type=&quot;NLog.Config.ConfigSectionHandler, NLog&quot; /&gt;
    &lt;!--&lt;section name=&quot;oracle.manageddataaccess.client&quot; type=&quot;OracleInternal.Common.ODPMSectionHandler, Oracle.ManagedDataAccess&quot; /&gt;--&gt;
    &lt;section name=&quot;entityFramework&quot; type=&quot;System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot; requirePermission=&quot;false&quot; /&gt;
&lt;/configSections&gt;
</code></pre></li><li><p>註解掉後可以正常執行，表示真的有吃到其他 config 內容</p><blockquote><p>以下是兩個可能影響 IIS 的較底層 config</p></blockquote><ul><li><p><code>applicationhost.config</code></p><blockquote><p>這是從 IIS7 開始加入的 config 設定，包含所有 site、應用程序、虛擬目錄、application pool 的定義跟 web server global 設定</p></blockquote><ul><li><p>IIS</p><blockquote><p>在 <code>system32\inetsrv\config</code> 資料夾下，紀錄 iis site 相關設定</p></blockquote></li><li><p>IIS express</p><ul><li><p>VS 2013 含以前</p><blockquote><p>位於 <code>%userprofile%\documents\iisexpress\config\</code> 或是 <code>%userprofile%\my documents\iisexpress\config\</code> 資料夾下</p></blockquote></li><li><p>VS 2013 開始</p><blockquote><p>位於專案 <code>.vs\config</code> 資料夾下</p></blockquote></li></ul></li></ul></li><li><p><code>machine.config</code></p><blockquote><p>Machine.config 包含全電腦的 dll binding、內建 remoting channels 和 ASP.NET 的 config 設定</p></blockquote><ul><li><p>32-bit</p><blockquote><p><code>%windir%\Microsoft.NET\Framework\{version}\config\machine.config</code></p></blockquote></li><li><p>64-bit</p><blockquote><p><code>%windir%\Microsoft.NET\Framework64\{version}\config\machine.config</code></p></blockquote></li><li><p>[version] 有 <code>v1.0.3705</code>, <code>v1.1.4322</code>, <code>v2.0.50727</code> or <code>v4.0.30319</code>.</p><blockquote><p>v3.0 and v3.5 包含在 v2.0.50727 中. <code>v4.5.x</code> and <code>v4.6.x</code> 包含在 v4.0.30319 中.</p></blockquote></li><li><p>因為 iis express 是 32-bit 所以要找 <code>%windir%\Microsoft.NET\Framework\{version}\config\machine.config</code></p></li></ul></li></ul></li><li><p>最後在 <code>%windir%\Microsoft.NET\Framework\v4.0.30319\CONFIG\machine.config</code> 中找到重複設定</p><blockquote><p>註解掉 machine.config 中的區段後，專案就可以正常執行了</p></blockquote></li></ol><h2 id=心得>心得</h2><p>因為其他同事電腦都沒遇到相同問題，未經證實的猜測：是因為我安裝了 ODAC(Oracle Data Access Component) 相關套件造成的，雖然後來我移除 ODAC 所有套件，這個設定還是沒有被清除，但我還是覺得它的嫌疑最大，當然也可能是我自己找不到確定原因硬要推給它 @@&rdquo;</p><p>剛好透過這個異常錯誤，了解到原來影響 IIS Express web site 的除了 web.config 還有其他 <code>applicationhost.config</code> 跟 <code>machine.config</code>，再次證實自己沒打好基礎跟自己還有好多不懂的東西！！</p><h1 id=參考資訊>參考資訊</h1><ol><li><a href=http://blog.darkthread.net/post-2014-04-22-duplicated-handler-entry-in-webconfig.aspx target=_blank>【茶包射手日記】怪異的web.config HttpHandler重複錯誤</a></li><li><a href=https://stackoverflow.com/questions/12946476/where-is-the-iis-express-configuration-metabase-file-found target=_blank>Where is the IIS Express configuration / metabase file found?</a></li><li><a href=https://stackoverflow.com/questions/2325473/where-is-machine-config target=_blank>Where Is Machine.Config?</a></li><li><a href=https://stackoverflow.com/questions/4762204/machine-config-and-processmodel-with-iis-express target=_blank>machine.config and processmodel with IIS express</a></li><li><a href="https://docs.microsoft.com/en-us/iis/get-started/planning-your-iis-architecture/the-configuration-system-in-iis-7?WT.mc_id=DOP-MVP-5002594" target=_blank>The Configuration System in IIS 7</a></li></ol></div><div class=post-copyright><p class=copyright-item><span class=item-title>文章作者</span>
<span class=item-content>Yowko Tsai</span></p><p class=copyright-item><span class=item-title>上次更新</span>
<span class=item-content>2020-09-01</span></p><p class=copyright-item><span class=item-title>授權合約</span>
<span class=item-content>本部落格 (<a href=//blog.yowko.com target=_blank>Yowko&#39;s Notes</a>) 所有的文章內容(包含圖片)，任何轉載行為，必須通知並獲本部落格作者 (<a href=mailto:yowko@yowko.com>Yowko Tsai</a>) 的同意始得轉載,且轉載皆須註明出處與作者。<br><br><div class=separator style=clear:both;text-align:center><a href=//i.creativecommons.org/l/by-nc-sa/3.0/tw/88x31.png imageanchor=1 style=margin-left:1em;margin-right:1em><img border=0 src=//i.creativecommons.org/l/by-nc-sa/3.0/tw/88x31.png></a></div><br>&nbsp;<a href=//blog.yowko.com target=_blank>Yowko&#39;s Notes</a> 由 <a href=https://www.facebook.com/yowko.tsai target=_blank>Yowko Tsai</a> 製作，以<a href=//creativecommons.org/licenses/by-nc-sa/3.0/tw/ target=_blank>創用CC 姓名標示-非商業性-相同方式分享 3.0 台灣 授權條款</a>&nbsp;釋出。</span></p></div><footer class=post-footer><div class=post-tags>標籤：
<a href=https://blog.yowko.com/tags/debug/>Debug</a>
<a href=https://blog.yowko.com/tags/iis-express/>IIS Express</a>
<a href=https://blog.yowko.com/tags/web.config/>web.config</a></div><nav class=post-nav><div><a class=prev href=https://blog.yowko.com/stackexchange-redis-timeout/ style=float:none><span class="next-text nav-mobile" style=display:inline-block>下一篇</span>
<i class="fas fa-arrow-circle-right"></i><span class="next-text nav-default">StackExchange 連線 Redis 出現 Timeout</span></a></div><div><a class=prev href=https://blog.yowko.com/pickles-specflow/ style=float:none><span class="prev-text nav-mobile" style=display:inline-block>上一篇</span>
<i class="fas fa-arrow-circle-left"></i><span class="prev-text nav-default">使用 Pickles 搭配 SpecFlow 產生即時更新文件(living documentation)</span></a></div></nav></footer></article></div><div id=disqus_thread></div><script type=text/javascript>var disqus_config=function(){this.page.url='https:\/\/blog.yowko.com\/iis-express-50019-config-duplicate\/';};(function(){if(window.location.hostname==='localhost')return;var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;var disqus_shortname='yowkonotes';dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:yowko@yowko.com class="iconfont icon-email" title=email></a><a href=https://www.linkedin.com/in/yowko/ class="iconfont icon-linkedin" title=linkedin></a><a href=https://github.com/yowko class="iconfont icon-github" title=github></a><a href=https://blog.yowko.com/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>由 <a class=hexo-link href=https://gohugo.io>Hugo</a> 強力驅動</span>
<span class=division>|</span>
<span class=theme-info>主題 -
<a class=theme-link href=https://github.com/huanlin/hugo-theme-even-more>Even More</a></span>
<span class=copyright-year>&copy;
2016 -
2021
<span class=heart><i class="iconfont icon-heart"></i></span><span class=author>Yowko Tsai</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src="https://blog.yowko.com/lib/highlight/highlight.pack.js?v=20171001"></script><script type=text/javascript src=https://blog.yowko.com/lib/jquery/jquery-3.2.1.min.js></script><script type=text/javascript src=https://blog.yowko.com/lib/slideout/slideout-1.0.1.min.js></script><script type=text/javascript src=https://blog.yowko.com/lib/fancybox/jquery.fancybox-3.1.20.min.js></script><script type=text/javascript src=https://blog.yowko.com/lib/instantclick/instantclick-3.0.1.min.js data-no-instant></script><script data-no-instant>InstantClick.init();</script><script type=text/javascript src="https://blog.yowko.com/dist/even.min.js?v=3.2.0"></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-88810280-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>