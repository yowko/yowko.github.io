<!doctype html><html lang=zh-tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>IIS 存取 LocalDB (.MDF) 時出現 Error 52 - Yowko&#39;s Notes</title><meta name=renderer content=webkit><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content=no-transform><meta http-equiv=cache-control content=no-siteapp><meta name=theme-color content=#f8f5ec><meta name=msapplication-navbutton-color content=#f8f5ec><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=#f8f5ec><meta name=author content="Yowko Tsai"><meta name=description content="IIS 存取 LocalDB (.MDF) 時出現 Error 52 資料庫是網頁應用程式儲存資料最常見的方式，存取資料的操作方法也最廣為人知，只是資料庫本身有維護及管理成本，如果目的只是本"><meta name=keywords content=yowko,.net,blog><meta name=generator content="Hugo 0.56.3"><meta name=msvalidate.01 content=FA1ADBDB8F0BBBD0F7F4E65CDEBF7898><link rel=canonical href=https://blog.yowko.com/iis-localdb-mdf-error-52/><link rel=apple-touch-icon sizes=180x180 href=https://blog.yowko.com/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://blog.yowko.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://blog.yowko.com/favicon-16x16.png><link rel=manifest href=https://blog.yowko.com/manifest.json><link rel=mask-icon href=https://blog.yowko.com/safari-pinned-tab.svg color=#5bbad5><link href="https://blog.yowko.com/dist/even.min.css?v=3.2.0" rel=stylesheet><link href=https://blog.yowko.com/lib/fancybox/jquery.fancybox-3.1.20.min.css rel=stylesheet><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.2.0/css/all.css integrity=sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ crossorigin=anonymous><meta property=og:title content="IIS 存取 LocalDB (.MDF) 時出現 Error 52"><meta property=og:description content="IIS 存取 LocalDB (.MDF) 時出現 Error 52 資料庫是網頁應用程式儲存資料最常見的方式，存取資料的操作方法也最廣為人知，只是資料庫本身有維護及管理成本，如果目的只是本"><meta property=og:type content=article><meta property=og:url content=https://blog.yowko.com/iis-localdb-mdf-error-52/><meta property=article:published_time content=2018-02-04T00:01:00+08:00><meta property=article:modified_time content=2021-11-02T00:36:58+08:00><meta itemprop=name content="IIS 存取 LocalDB (.MDF) 時出現 Error 52"><meta itemprop=description content="IIS 存取 LocalDB (.MDF) 時出現 Error 52 資料庫是網頁應用程式儲存資料最常見的方式，存取資料的操作方法也最廣為人知，只是資料庫本身有維護及管理成本，如果目的只是本"><meta itemprop=datePublished content=2018-02-04T00:01:00&#43;08:00><meta itemprop=dateModified content=2021-11-02T00:36:58&#43;08:00><meta itemprop=wordCount content=1050><meta itemprop=keywords content="IIS,LocalDB,SQL Server,"><meta name=twitter:card content=summary><meta name=twitter:title content="IIS 存取 LocalDB (.MDF) 時出現 Error 52"><meta name=twitter:description content="IIS 存取 LocalDB (.MDF) 時出現 Error 52 資料庫是網頁應用程式儲存資料最常見的方式，存取資料的操作方法也最廣為人知，只是資料庫本身有維護及管理成本，如果目的只是本"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--><link href=https://blog.yowko.com/opensearch.xml rel=search title="Content search" type=application/opensearchdescription+xml></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=https://blog.yowko.com/ class=logo>Yowko&#39;s Notes</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=https://blog.yowko.com/><li class=mobile-menu-item>首頁</li></a><a href=https://blog.yowko.com/post/><li class=mobile-menu-item>歷史筆記</li></a><a href=https://blog.yowko.com/tags/><li class=mobile-menu-item>內容標籤</li></a><a href=https://blog.yowko.com/search><li class=mobile-menu-item>站內搜尋</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header style=height:118px;padding-bottom:0><div class=logo-wrapper><a href=https://blog.yowko.com/ class=logo>Yowko&#39;s Notes</a></div><div style=padding-bottom:60px></div></nav><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=https://blog.yowko.com/>首頁</a></li><li class=menu-item><a class=menu-item-link href=https://blog.yowko.com/post/>歷史筆記</a></li><li class=menu-item><a class=menu-item-link href=https://blog.yowko.com/tags/>內容標籤</a></li><li class=menu-item><a class=menu-item-link href=https://blog.yowko.com/search>站內搜尋</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><hr style="border-top:1px solid #e6e6e6;border-bottom:0;padding:0"><div id=content class=content><article class=post><header class=post-header><div class=post-meta><span class=post-time>2018-02-04</span>
<span class=more-meta>約 1050 字</span>
<span class=more-meta>預計閱讀 3 分鐘</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>文章目錄</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><ul><li><a href=#iis-存取-localdb-mdf-時出現-error-52>IIS 存取 LocalDB (.MDF) 時出現 Error 52</a></li><li><a href=#前提說明>前提說明</a></li><li><a href=#錯誤訊息>錯誤訊息</a></li><li><a href=#解決方式>解決方式</a></li><li><a href=#心得>心得</a></li><li><a href=#參考資訊>參考資訊</a></li></ul></li></ul></nav></div></div><div class=post-content><h2 id=iis-存取-localdb-mdf-時出現-error-52>IIS 存取 LocalDB (.MDF) 時出現 Error 52</h2><p>資料庫是網頁應用程式儲存資料最常見的方式，存取資料的操作方法也最廣為人知，只是資料庫本身有維護及管理成本，如果目的只是本機開發使用，透過 IIS Express 搭配 LocalDB 就可以滿足大部份情境了，不過一旦需要實際部署至 IIS 上，LocalDB 就不適用了，因為 LocalDB 是 SQL Server Express 的一種特殊執行模式，而 SQL Server Express 本來就不適用在 production 上，加上 LocalDB 也不是設計用來搭配 IIS</p><p>剛好最近有個功能想要模擬不同時區的顯示，可是又不想大費周章管理架設 SQL Server，於是就想到透過 LocalDB 來簡單驗證功能正確性，有段時間沒有這麼做了，設定方式有些生疏，順手紀錄一下以備日後又想偷懶XD</p><h2 id=前提說明>前提說明</h2><ol><li><p>透過 EntityFramework 連線 LocalDB 取得資料做顯示</p><ul><li><p>web.config 連線</p><pre><code class=language-xml>&lt;add name=&quot;TestDateTimeEntities&quot; connectionString=&quot;metadata=res://*/Models.TestDateTime.csdl|res://*/Models.TestDateTime.ssdl|res://*/Models.TestDateTime.msl;provider=System.Data.SqlClient;provider connection string=&amp;quot;data source=(LocalDB)\MSSQLLocalDB;attachdbfilename=|DataDirectory|\Database1.mdf;integrated security=True;connect timeout=30;MultipleActiveResultSets=True;App=EntityFramework&amp;quot;&quot; providerName=&quot;System.Data.EntityClient&quot; /&gt;
</code></pre></li></ul></li><li><p>local 正常開啟</p><p><img src=https://user-images.githubusercontent.com/3851540/35768879-90ee4880-093d-11e8-92ea-ec235080ad32.png alt=1localok></p></li><li><p>部署至遠端 IIS 後出現錯誤</p><p><img src=https://user-images.githubusercontent.com/3851540/35768880-9116899e-093d-11e8-81ee-5601f66635e7.png alt=2iiserror></p></li></ol><h2 id=錯誤訊息>錯誤訊息</h2><ol><li><p>訊息內容</p><ul><li><p>英文</p><pre><code class=language-log>Server Error in '/' Application.
系統找不到指定的檔案。
Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 
        
Exception Details: System.ComponentModel.Win32Exception: 系統找不到指定的檔案。
        
Source Error: 
        
An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.
        
Stack Trace: 
            
[Win32Exception (0x80004005): 系統找不到指定的檔案。]
        
[SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 52 - Unable to locate a Local Database Runtime installation. Verify that SQL Server Express is properly installed and that the Local Database Runtime feature is enabled.)]
</code></pre></li><li><p>中文</p><pre><code class=language-log>'/' 應用程式中發生伺服器錯誤。
系統找不到指定的檔案。
描述: 在執行目前 Web 要求的過程中發生未處理的例外狀況。請檢閱堆疊追蹤以取得錯誤的詳細資訊，以及在程式碼中產生的位置。 
        
例外狀況詳細資訊: System.ComponentModel.Win32Exception: 系統找不到指定的檔案。
        
原始程式錯誤: 
        
在執行目前 Web 要求期間，產生未處理的例外狀況。如需有關例外狀況來源與位置的資訊，可以使用下列的例外狀況堆疊追蹤取得。
        
堆疊追蹤: 
            
[Win32Exception (0x80004005): 系統找不到指定的檔案。]
        
[SqlException (0x80131904): 建立連接至 SQL Server 時，發生網路相關或執行個體特定的錯誤。找不到或無法存取伺服器。確認執行個名稱是否正確，以及 SQL Server 是否設定為允許遠端連線。 (provider: SQL Network Interfaces, error: 52 - 找不到 Local Database Runtime 安裝。請確認 SQL Server Express 已正確安裝且 Local Database Runtime 功能已啟用。)]
</code></pre></li></ul></li><li><p>錯誤截圖</p><ul><li><p>英文</p><p><img src=https://user-images.githubusercontent.com/3851540/35768881-913e335e-093d-11e8-8d4c-8376986d37dd.png alt=3engerror></p></li><li><p>中文</p><p><img src=https://user-images.githubusercontent.com/3851540/35768882-9165c68a-093d-11e8-8efe-ca4548cab415.png alt=4zherror></p></li></ul></li></ol><h2 id=解決方式>解決方式</h2><ol><li><p>確認使用 LocalDB 的版本</p><ul><li>double click &ndash;&gt; 開啟 <code>.mdf</code></li><li><p>執行 <code>SELECT @@VERSION</code></p><p><img src=https://user-images.githubusercontent.com/3851540/35768883-918d678a-093d-11e8-8d7f-e9301239c6e5.png alt=5version></p><pre><code class=language-log>Microsoft SQL Server 2014 - 12.0.2269.0 (X64)   Jun 10 2015 03:35:45   Copyright (c) Microsoft Corporation  Express Edition (64-bit) on Windows NT 6.3 &lt;X64&gt; (Build 10586: )
</code></pre></li></ul></li><li><p>下載並安裝 MDF 對應版本 LocalDB</p><ul><li><p>SQL Server 2014 - <a href="https://www.microsoft.com/zh-tw/download/details.aspx?id=42299" target=_blank>Microsoft® SQL Server® 2014 Express</a></p><blockquote><p>相關介紹：<a href=https://msdn.microsoft.com/en-US/library/hh510202%28SQL.120%29.aspx target=_blank>SQL Server 2014 Express LocalDB</a></p></blockquote></li><li><p>SQL Server 2016 - <a href="https://www.microsoft.com/zh-tw/download/details.aspx?id=54284" target=_blank>Microsoft® SQL Server® 2016 Service Pack 1 Express</a></p><blockquote><p>相關介紹：<a href="https://docs.microsoft.com/zh-tw/sql/database-engine/configure-windows/sql-server-2016-express-localdb?WT.mc_id=DOP-MVP-5002594" target=_blank>SQL Server 2016 Express LocalDB</a></p></blockquote></li></ul></li></ol><h2 id=心得>心得</h2><p>微軟的檔案下載搞得好難找呀，在 SQL Server 2016 說明頁面上的下載連結是連到 SQL Server 2017，點下載卻只有評估版，要透過搜尋才能找到 SQL Server 2016 Express，使用者體驗有加強的空間</p><h2 id=參考資訊>參考資訊</h2><ol><li><a href="https://forums.asp.net/t/2090050.aspx?Web+Application+publishing+in+IIS+with+MDF+database+file?WT.mc_id=DOP-MVP-5002594" target=_blank>Web Application publishing in IIS with .MDF database file</a></li><li><a href=http://jaryl-lan.blogspot.tw/2014/08/localdb-connection-to-localdb-failed.html target=_blank>[LocalDB] Connecting to LocalDB failed [Error Code 52]</a></li><li><a href="https://msdn.microsoft.com/en-US/library/hh510202%28SQL.120%29.aspx?WT.mc_id=DOP-MVP-5002594" target=_blank>SQL Server 2014 Express LocalDB</a></li><li><a href="https://docs.microsoft.com/zh-tw/sql/database-engine/configure-windows/sql-server-2016-express-localdb?WT.mc_id=DOP-MVP-5002594" target=_blank>SQL Server 2016 Express LocalDB</a></li></ol></div><div class=post-copyright><p class=copyright-item><span class=item-title>文章作者</span>
<span class=item-content>Yowko Tsai</span></p><p class=copyright-item><span class=item-title>上次更新</span>
<span class=item-content>2021-11-02</span></p><p class=copyright-item><span class=item-title>授權合約</span>
<span class=item-content>本部落格 (<a href=//blog.yowko.com target=_blank>Yowko&#39;s Notes</a>) 所有的文章內容(包含圖片)，任何轉載行為，必須通知並獲本部落格作者 (<a href=mailto:yowko@yowko.com>Yowko Tsai</a>) 的同意始得轉載,且轉載皆須註明出處與作者。<br><br><div class=separator style=clear:both;text-align:center><a href=//i.creativecommons.org/l/by-nc-sa/3.0/tw/88x31.png imageanchor=1 style=margin-left:1em;margin-right:1em><img border=0 src=//i.creativecommons.org/l/by-nc-sa/3.0/tw/88x31.png></a></div><br>&nbsp;<a href=//blog.yowko.com target=_blank>Yowko&#39;s Notes</a> 由 <a href=https://www.facebook.com/yowko.tsai target=_blank>Yowko Tsai</a> 製作，以<a href=//creativecommons.org/licenses/by-nc-sa/3.0/tw/ target=_blank>創用CC 姓名標示-非商業性-相同方式分享 3.0 台灣 授權條款</a>&nbsp;釋出。</span></p></div><footer class=post-footer><div class=post-tags>標籤：
<a href=https://blog.yowko.com/tags/iis/>IIS</a>
<a href=https://blog.yowko.com/tags/localdb/>LocalDB</a>
<a href=https://blog.yowko.com/tags/sql-server/>SQL Server</a></div><nav class=post-nav><div><a class=prev href=https://blog.yowko.com/csharp-datetime-javascript-date/ style=float:none><span class="next-text nav-mobile" style=display:inline-block>下一篇</span>
<i class="fas fa-arrow-circle-right"></i><span class="next-text nav-default">C# DateTime 轉 JavaScript Date (依使用者偏好區域來顯示時間)</span></a></div><div><a class=prev href=https://blog.yowko.com/iis-enable-cors/ style=float:none><span class="prev-text nav-mobile" style=display:inline-block>上一篇</span>
<i class="fas fa-arrow-circle-left"></i><span class="prev-text nav-default">IIS 設定啟用 CORS (Cross-Origin Resource Sharing) - 跨來源資源共用</span></a></div></nav></footer></article></div><div id=disqus_thread></div><script type=text/javascript>var disqus_config=function(){this.page.url='https:\/\/blog.yowko.com\/iis-localdb-mdf-error-52\/';};(function(){if(window.location.hostname==='localhost')return;var dsq=document.createElement('script');dsq.type='text/javascript';dsq.async=true;var disqus_shortname='yowkonotes';dsq.src='//'+disqus_shortname+'.disqus.com/embed.js';(document.getElementsByTagName('head')[0]||document.getElementsByTagName('body')[0]).appendChild(dsq);})();</script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:yowko@yowko.com class="iconfont icon-email" title=email></a><a href=https://www.linkedin.com/in/yowko/ class="iconfont icon-linkedin" title=linkedin></a><a href=https://github.com/yowko class="iconfont icon-github" title=github></a><a href=https://blog.yowko.com/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>由 <a class=hexo-link href=https://gohugo.io>Hugo</a> 強力驅動</span>
<span class=division>|</span>
<span class=theme-info>主題 -
<a class=theme-link href=https://github.com/huanlin/hugo-theme-even-more>Even More</a></span>
<span class=copyright-year>&copy;
2016 -
2023
<span class=heart><i class="iconfont icon-heart"></i></span><span class=author>Yowko Tsai</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src="https://blog.yowko.com/lib/highlight/highlight.pack.js?v=20171001"></script><script type=text/javascript src=https://blog.yowko.com/lib/jquery/jquery-3.2.1.min.js></script><script type=text/javascript src=https://blog.yowko.com/lib/slideout/slideout-1.0.1.min.js></script><script type=text/javascript src=https://blog.yowko.com/lib/fancybox/jquery.fancybox-3.1.20.min.js></script><script type=text/javascript src=https://blog.yowko.com/lib/instantclick/instantclick-3.0.1.min.js data-no-instant></script><script data-no-instant>InstantClick.init();</script><script type=text/javascript src="https://blog.yowko.com/dist/even.min.js?v=3.2.0"></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-7PF6W2W48Y"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-7PF6W2W48Y');</script></body></html>