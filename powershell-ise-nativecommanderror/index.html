<!doctype html><html lang=zh-tw><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>PowerShell ISE 執行外部執行檔(.exe) 時出現 RemoteException NativeCommandError - Yowko&#39;s Notes</title><meta name=renderer content=webkit><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content=no-transform><meta http-equiv=cache-control content=no-siteapp><meta name=theme-color content=#f8f5ec><meta name=msapplication-navbutton-color content=#f8f5ec><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=#f8f5ec><meta name=author content="Yowko Tsai"><meta name=description content="PowerShell ISE 執行外部執行檔(.exe) 時出現 RemoteException NativeCommandError 打算使用 PowerShell 叫用 PsExec.exe 來執行一些指令，使用 PowerShell ISE 開發時持續出現錯誤訊息，查了些資料，紀錄一下 結論 依以往的範例"><meta name=keywords content=yowko,.net,blog><meta name=generator content="Hugo 0.56.3"><meta name=msvalidate.01 content=FA1ADBDB8F0BBBD0F7F4E65CDEBF7898><link rel=canonical href=https://blog.yowko.com/powershell-ise-nativecommanderror/><link rel=apple-touch-icon sizes=180x180 href=https://blog.yowko.com/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://blog.yowko.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://blog.yowko.com/favicon-16x16.png><link rel=manifest href=https://blog.yowko.com/manifest.json><link rel=mask-icon href=https://blog.yowko.com/safari-pinned-tab.svg color=#5bbad5><link href="https://blog.yowko.com/dist/even.min.css?v=3.2.0" rel=stylesheet><link href=https://blog.yowko.com/lib/fancybox/jquery.fancybox-3.1.20.min.css rel=stylesheet><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.2.0/css/all.css integrity=sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ crossorigin=anonymous><meta property=og:title content="PowerShell ISE 執行外部執行檔(.exe) 時出現 RemoteException NativeCommandError"><meta property=og:description content="PowerShell ISE 執行外部執行檔(.exe) 時出現 RemoteException NativeCommandError 打算使用 PowerShell 叫用 PsExec.exe 來執行一些指令，使用 PowerShell ISE 開發時持續出現錯誤訊息，查了些資料，紀錄一下 結論 依以往的範例"><meta property=og:type content=article><meta property=og:url content=https://blog.yowko.com/powershell-ise-nativecommanderror/><meta property=article:published_time content=2017-03-22T02:44:34+08:00><meta property=article:modified_time content=2021-10-28T00:42:34+08:00><meta itemprop=name content="PowerShell ISE 執行外部執行檔(.exe) 時出現 RemoteException NativeCommandError"><meta itemprop=description content="PowerShell ISE 執行外部執行檔(.exe) 時出現 RemoteException NativeCommandError 打算使用 PowerShell 叫用 PsExec.exe 來執行一些指令，使用 PowerShell ISE 開發時持續出現錯誤訊息，查了些資料，紀錄一下 結論 依以往的範例"><meta itemprop=datePublished content=2017-03-22T02:44:34&#43;08:00><meta itemprop=dateModified content=2021-10-28T00:42:34&#43;08:00><meta itemprop=wordCount content=572><meta itemprop=keywords content=PowerShell,><meta name=twitter:card content=summary><meta name=twitter:title content="PowerShell ISE 執行外部執行檔(.exe) 時出現 RemoteException NativeCommandError"><meta name=twitter:description content="PowerShell ISE 執行外部執行檔(.exe) 時出現 RemoteException NativeCommandError 打算使用 PowerShell 叫用 PsExec.exe 來執行一些指令，使用 PowerShell ISE 開發時持續出現錯誤訊息，查了些資料，紀錄一下 結論 依以往的範例"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--><link href=https://blog.yowko.com/opensearch.xml rel=search title="Content search" type=application/opensearchdescription+xml></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=https://blog.yowko.com/ class=logo>Yowko&#39;s Notes</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=https://blog.yowko.com/><li class=mobile-menu-item>首頁</li></a><a href=https://blog.yowko.com/post/><li class=mobile-menu-item>歷史筆記</li></a><a href=https://blog.yowko.com/tags/><li class=mobile-menu-item>內容標籤</li></a><a href=https://blog.yowko.com/search><li class=mobile-menu-item>站內搜尋</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header style=height:118px;padding-bottom:0><div class=logo-wrapper><a href=https://blog.yowko.com/ class=logo>Yowko&#39;s Notes</a></div><div style=padding-bottom:60px></div></nav><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=https://blog.yowko.com/>首頁</a></li><li class=menu-item><a class=menu-item-link href=https://blog.yowko.com/post/>歷史筆記</a></li><li class=menu-item><a class=menu-item-link href=https://blog.yowko.com/tags/>內容標籤</a></li><li class=menu-item><a class=menu-item-link href=https://blog.yowko.com/search>站內搜尋</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><hr style="border-top:1px solid #e6e6e6;border-bottom:0;padding:0"><div id=content class=content><article class=post><header class=post-header><div class=post-meta><span class=post-time>2017-03-22</span>
<span class=more-meta>約 572 字</span>
<span class=more-meta>預計閱讀 2 分鐘</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>文章目錄</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><ul><li><a href=#powershell-ise-執行外部執行檔-exe-時出現-remoteexception-nativecommanderror>PowerShell ISE 執行外部執行檔(.exe) 時出現 RemoteException NativeCommandError</a></li><li><a href=#結論>結論</a></li><li><a href=#實際發生現象>實際發生現象</a></li><li><a href=#問題發生原因>問題發生原因</a></li><li><a href=#如何解決>如何解決</a></li><li><a href=#心得>心得</a></li><li><a href=#參考資料>參考資料</a></li></ul></li></ul></nav></div></div><div class=post-content><h2 id=powershell-ise-執行外部執行檔-exe-時出現-remoteexception-nativecommanderror>PowerShell ISE 執行外部執行檔(.exe) 時出現 RemoteException NativeCommandError</h2><p>打算使用 PowerShell 叫用 PsExec.exe 來執行一些指令，使用 PowerShell ISE 開發時持續出現錯誤訊息，查了些資料，紀錄一下</p><h2 id=結論>結論</h2><p>依以往的範例 - debug 就該先說結論：這個是 PowerShell ISE 的內部機制，透過 console 不會出現錯誤提示</p><h2 id=實際發生現象>實際發生現象</h2><blockquote><p>嘗試執行 <code>nslookup TW.yahoo.com</code></p></blockquote><ol><li><p>以 PowerShell ISE 執行</p><ul><li><p>錯誤訊息</p><pre><code class=language-log>nslookup : Non-authoritative answer:
At line:1 char:1
+ nslookup TW.yahoo.com
+ ~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (Non-authoritative answer::String) [], RemoteException
    + FullyQualifiedErrorId : NativeCommandError
</code></pre></li><li><p>錯誤截圖</p><p><img src=https://cloud.githubusercontent.com/assets/3851540/24092603/363f41e6-0d8a-11e7-91f5-08b8b5b2248b.png alt=1iseerror></p></li><li><p>以結果來看有正確回應</p></li></ul></li><li><p>以 PowerShell console 執行</p><ul><li><p>正確執行，並正確回應結果</p><p><img src=https://cloud.githubusercontent.com/assets/3851540/24092601/361cb7f2-0d8a-11e7-8e0e-c8770022233c.png alt=2consolepass></p></li></ul></li></ol><h2 id=問題發生原因>問題發生原因</h2><blockquote><p>PowerShell ISE 與 PowerShell console 在處理 STDERR (standard error) 時兩者行為不同造成的</p></blockquote><p>外部程式會透過 STDERR (standard error) 來輸出執行資訊，PowerShell console 執行這類外部程式時會另起個 console 來處理程式的回應訊息而繞過了 PowerShell 的訊息處理機制，所以 PowerShell console 本身並不知道 STDERR (standard error) 的存在也就無法揭露錯誤，而 PowerShell ISE 因為沒有另起個 console 來處理，相關訊息會直接讓 PowerShell ISE 處理，以致 STDERR (standard error) 就會被 PowerShell ISE 攔截並標記成錯誤了</p><h2 id=如何解決>如何解決</h2><ol><li>直接使用 PowerShell console</li><li><p>PowerShell ISE 中加上 <code>2&gt;$null</code>
&gt; 把 stderr 吃掉</p><ul><li><p><code>nslookup TW.yahoo.com 2&gt;$null</code></p><p><img src=https://cloud.githubusercontent.com/assets/3851540/24092601/361cb7f2-0d8a-11e7-8e0e-c8770022233c.png alt=3resolved></p></li></ul></li></ol><h2 id=心得>心得</h2><p>這個問題我查了好久，很多網友認為這是 PowerShell 的 bug，也有不少認為是 PowerShell 的設計缺陷。站在使用者的立場，工具的設計方向當然不是我能決定跟批評的，但至少也該有個比較官方的說明文件或是解決方式，不然只是讓使用者更無所適從，使用者遇到問題解決不了無形中也限制了軟體的發展性。有感而發，當然是因為問題查了好幾天還不確定結論是不是正確XD</p><h2 id=參考資料>參考資料</h2><ol><li><a href=http://stackoverflow.com/questions/18380227/psexec-throws-error-messages-but-works-without-any-problems target=_blank>PsExec Throws Error Messages, but works without any problems</a></li><li><a href=http://stackoverflow.com/questions/2095088/error-when-calling-3rd-party-executable-from-powershell-when-using-an-ide target=_blank>Error when calling 3rd party executable from Powershell when using an IDE</a></li><li><a href=http://stackoverflow.com/questions/1394084/ignoring-an-errorlevel-0-in-windows-powershell/1416933 target=_blank>Ignoring an errorlevel != 0 in Windows Powershell</a></li><li><a href=http://stackoverflow.com/questions/2095088/error-when-calling-3rd-party-executable-from-powershell-when-using-an-ide target=_blank>Error when calling 3rd party executable from Powershell when using an IDE</a></li></ol></div><div class=post-copyright><p class=copyright-item><span class=item-title>文章作者</span>
<span class=item-content>Yowko Tsai</span></p><p class=copyright-item><span class=item-title>上次更新</span>
<span class=item-content>2021-10-28</span></p><p class=copyright-item><span class=item-title>授權合約</span>
<span class=item-content>本部落格 (<a href=//blog.yowko.com target=_blank>Yowko&#39;s Notes</a>) 所有的文章內容(包含圖片)，任何轉載行為，必須通知並獲本部落格作者 (<a href=mailto:yowko@yowko.com>Yowko Tsai</a>) 的同意始得轉載,且轉載皆須註明出處與作者。<br><br><div class=separator style=clear:both;text-align:center><a href=//i.creativecommons.org/l/by-nc-sa/3.0/tw/88x31.png imageanchor=1 style=margin-left:1em;margin-right:1em><img border=0 src=//i.creativecommons.org/l/by-nc-sa/3.0/tw/88x31.png></a></div><br>&nbsp;<a href=//blog.yowko.com target=_blank>Yowko&#39;s Notes</a> 由 <a href=https://www.facebook.com/yowko.tsai target=_blank>Yowko Tsai</a> 製作，以<a href=//creativecommons.org/licenses/by-nc-sa/3.0/tw/ target=_blank>創用CC 姓名標示-非商業性-相同方式分享 3.0 台灣 授權條款</a>&nbsp;釋出。</span></p></div><footer class=post-footer><div class=post-tags>標籤：
<a href=https://blog.yowko.com/tags/powershell/>PowerShell</a></div><nav class=post-nav><div><a class=prev href=https://blog.yowko.com/redis-persistence/ style=float:none><span class="next-text nav-mobile" style=display:inline-block>下一篇</span>
<i class="fas fa-arrow-circle-right"></i><span class="next-text nav-default">關於 Redis Persistence - 資料持久化</span></a></div><div><a class=prev href=https://blog.yowko.com/redis-bechmack/ style=float:none><span class="prev-text nav-mobile" style=display:inline-block>上一篇</span>
<i class="fas fa-arrow-circle-left"></i><span class="prev-text nav-default">Redis bechmack 用法與參數說明</span></a></div></nav></footer></article></div><script src=https://giscus.app/client.js data-repo=yowko/yowko.github.io data-repo-id data-category=Announcements data-category-id=DIC_kwDOCsJzG84CW4SD data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=preferred_color_scheme data-lang=zh-TW crossorigin=anonymous async></script></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:yowko@yowko.com class="iconfont icon-email" title=email></a><a href=https://www.linkedin.com/in/yowko/ class="iconfont icon-linkedin" title=linkedin></a><a href=https://github.com/yowko class="iconfont icon-github" title=github></a><a href=https://blog.yowko.com/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>由 <a class=hexo-link href=https://gohugo.io>Hugo</a> 強力驅動</span>
<span class=division>|</span>
<span class=theme-info>主題 -
<a class=theme-link href=https://github.com/huanlin/hugo-theme-even-more>Even More</a></span>
<span class=copyright-year>&copy;
2016 -
2023
<span class=heart><i class="iconfont icon-heart"></i></span><span class=author>Yowko Tsai</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src="https://blog.yowko.com/lib/highlight/highlight.pack.js?v=20171001"></script><script type=text/javascript src=https://blog.yowko.com/lib/jquery/jquery-3.2.1.min.js></script><script type=text/javascript src=https://blog.yowko.com/lib/slideout/slideout-1.0.1.min.js></script><script type=text/javascript src=https://blog.yowko.com/lib/fancybox/jquery.fancybox-3.1.20.min.js></script><script type=text/javascript src=https://blog.yowko.com/lib/instantclick/instantclick-3.0.1.min.js data-no-instant></script><script data-no-instant>InstantClick.init();</script><script type=text/javascript src="https://blog.yowko.com/dist/even.min.js?v=3.2.0"></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','G-7PF6W2W48Y','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>